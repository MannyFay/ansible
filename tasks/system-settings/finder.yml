- name: Set Up Finder 
  become: true
  become_user: "{{ username }}"
  command: "{{ item }}"
  with_items:
    - "defaults write com.apple.finder ShowExternalHardDrivesOnDesktop -bool false"
    - "defaults write com.apple.Finder AppleShowAllFiles -bool true"
    - "defaults write com.apple.finder AppleShowAllFiles TRUE"
    - "defaults write NSGlobalDomain AppleShowAllExtensions -bool true"
    - "defaults write com.apple.finder ShowStatusBar -bool true"
    - "defaults write com.apple.finder _FXShowPosixPathInTitle -bool true"
    - "defaults write com.apple.finder FXEnableExtensionChangeWarning -bool false"
    - "defaults write com.apple.finder FXPreferredViewStyle Clmv"
    - "defaults write com.apple.desktopservices DSDontWriteNetworkStores -bool true"
    - "defaults write com.apple.finder QLEnableTextSelection -bool true"
    - "defaults write com.apple.screencapture location -string '$HOME/Desktop'"
    - "defaults write com.apple.screencapture type -string 'png'"
    - "defaults write NSGlobalDomain NSNavPanelExpandedStateForSaveMode -bool true"
    - "defaults write NSGlobalDomain PMPrintingExpandedStateForPrint -bool true"
    - "defaults write NSGlobalDomain PMPrintingExpandedStateForPrint2 -bool true"
    - "defaults write com.apple.systempreferences NSQuitAlwaysKeepsWindows -bool false"
    - "defaults write com.apple.systempreferences NSQuitAlwaysKeepsWindows -bool false"

- name: Change Mode of Finder Script to an Executable
  become_user: "{{ username }}"
  become: true
  command: chmod +x "{{ personal_github_directory }}/ansible/scripts/system-settings/finder.sh"

- name: Run Finder Script
  become: true
  shell: "{{ personal_github_directory }}/ansible/scripts/system-settings/finder.sh"

- name: Copy finder_empty_bin.sh to Remote Host
  copy:
    src: "{{ personal_github_directory }}/ansible/scripts/system-settings/finder_empty_bin.sh"
    dest: /usr/local/bin/empty_trash.sh
    mode: '0755'

- name: Schedule Weekly Cron Job to Empty Trash
  cron:
    name: Empty Trash Weekly
    minute: 0
    hour: 12 
    job: /usr/local/bin/empty_empty_bin.sh
    state: present

- name: Copy finder_monitor_disk_space.sh to Remote Host
  copy:
    src: "{{ personal_github_directory }}/ansible/scripts/system-settings/finder_monitor_disk_space.sh"
    dest: /usr/local/bin/monitor_disk_space.sh
    mode: '0755'

- name: Add Cron Job for Disk Space Monitoring
  cron:
    name: Disk Space Monitoring
    minute: '0'
    hour: '*'
    job: /usr/local/bin/monitor_disk_space.sh

    